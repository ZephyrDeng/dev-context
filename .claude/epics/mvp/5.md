---
name: 核心 MCP 工具业务逻辑
status: closed
created: 2025-09-06T14:17:49Z
updated: 2025-09-07T07:15:00Z
github: https://github.com/ZephyrDeng/dev-context/issues/5
depends_on: []
parallel: false
conflicts_with: []
---


# Task: 核心 MCP 工具业务逻辑

## Description
实现三个核心 MCP 工具的业务逻辑，包括参数验证、数据查询、结果处理和响应格式化。这些工具是系统的核心价值提供者，直接服务于 AI 助手的前端资讯查询需求。

## Acceptance Criteria
- [ ] 实现 `get_weekly_frontend_news` 工具完整逻辑
- [ ] 实现 `search_frontend_topic` 工具完整逻辑  
- [ ] 实现 `get_trending_repositories` 工具完整逻辑
- [ ] 建立统一的参数验证和错误处理机制
- [ ] 实现查询结果的智能排序和分页
- [ ] 支持查询结果的多种输出格式
- [ ] 集成缓存层提升查询性能

## Technical Details
**三个核心 MCP 工具**:

**1. get_weekly_frontend_news**
- **功能**: 获取指定时间范围内的前端开发资讯
- **参数**: time_range (1d/3d/7d), category (js/css/react/vue), limit
- **数据源**: Dev.to API, CSS-Tricks RSS, Hacker News API
- **处理逻辑**: 时间过滤 + 内容分类 + 相关度排序

**2. search_frontend_topic**
- **功能**: 基于关键词搜索相关前端主题和讨论
- **参数**: keywords, source_types, limit, sort_by
- **数据源**: 全部数据源的统一搜索
- **处理逻辑**: 关键词匹配 + 权重计算 + 结果聚合

**3. get_trending_repositories**
- **功能**: 获取 GitHub 上的热门前端相关仓库
- **参数**: language (js/ts/css), time_range, min_stars
- **数据源**: GitHub Trending API + GitHub Search API
- **处理逻辑**: 趋势分析 + 活跃度评分 + 语言过滤

**关键文件和位置**:
- `internal/tools/weekly_news.go` - 周报资讯工具
- `internal/tools/topic_search.go` - 主题搜索工具  
- `internal/tools/trending_repos.go` - 热门仓库工具
- `internal/tools/handler.go` - 通用处理逻辑
- `internal/tools/validation.go` - 参数验证框架
- `internal/tools/formatter.go` - 响应格式化

**工具注册示例**:
```go
server.AddTool("get_weekly_frontend_news", &mcp.Tool{
    Description: "获取指定时间范围内的前端开发资讯",
    InputSchema: &jsonschema.Schema{
        Type: "object",
        Properties: map[string]*jsonschema.Schema{
            "time_range": {Type: "string", Enum: []interface{}{"1d", "3d", "7d"}},
            "category": {Type: "string"},
            "limit": {Type: "integer", Minimum: 1, Maximum: 50},
        },
        Required: []string{"time_range"},
    },
    Handler: handleWeeklyNews,
})
```

## Dependencies
- [ ] Task 001 - MCP SDK 集成设置完成
- [ ] Task 002 - 数据采集系统完成  
- [ ] Task 003 - 缓存管理系统完成
- [ ] Task 005 - 数据处理和格式化完成
- [ ] JSON Schema 验证库集成

## Effort Estimate
- Size: L
- Hours: 18-24 hours
- Parallel: false (需要依赖多个前置任务完成)

## Definition of Done
- [ ] 三个工具都能正确处理有效输入并返回预期结果
- [ ] 参数验证能够拦截所有无效输入并返回友好错误
- [ ] 查询响应时间 < 5 秒 (冷启动) / < 500ms (缓存命中)
- [ ] 结果数据准确性 > 95%，无重复和无效数据
- [ ] 支持并发查询，单个工具支持 20+ 并发请求
- [ ] 完整的错误处理，包括数据源失效的优雅降级
- [ ] 通过集成测试，模拟真实 MCP 客户端调用场景
